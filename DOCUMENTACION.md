# üìã Documentaci√≥n T√©cnica - Proyecto Globales

## üéØ Visi√≥n General del Proyecto

**Proyecto Globales** es una plataforma de gesti√≥n empresarial white-label para crear aplicaciones personalizadas de citas y gesti√≥n para diversos negocios. Permite a emprendedores crear marcas digitales con funcionalidades espec√≠ficas seg√∫n su tipo de negocio.

### üèóÔ∏è Arquitectura del Sistema

El sistema se compone de:

1. **Backend API (NestJS)** - Puerto 3000
2. **App Mobile (React Native/Expo)** - Cliente m√≥vil

---

## üõ†Ô∏è Backend API (NestJS)

### üìÇ Estructura del Proyecto

```
backend/
‚îú‚îÄ‚îÄ .env                    # Variables de entorno
‚îú‚îÄ‚îÄ .env.example           # Plantilla de variables de entorno
‚îú‚îÄ‚îÄ eslint.config.mjs      # Configuraci√≥n ESLint
‚îú‚îÄ‚îÄ nest-cli.json          # Configuraci√≥n del CLI de NestJS
‚îú‚îÄ‚îÄ package.json           # Dependencias y scripts
‚îú‚îÄ‚îÄ tsconfig.json          # Configuraci√≥n TypeScript
‚îú‚îÄ‚îÄ tsconfig.build.json    # Configuraci√≥n TypeScript para build
‚îú‚îÄ‚îÄ generated/             # Archivos generados por Prisma
‚îÇ   ‚îî‚îÄ‚îÄ prisma/           # Cliente Prisma generado
‚îú‚îÄ‚îÄ prisma/               # Configuraci√≥n de base de datos
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma     # Esquema de la base de datos
‚îÇ   ‚îî‚îÄ‚îÄ migrations/       # Migraciones de la base de datos
‚îú‚îÄ‚îÄ src/                  # C√≥digo fuente principal
‚îÇ   ‚îú‚îÄ‚îÄ main.ts           # Punto de entrada
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts     # M√≥dulo ra√≠z
‚îÇ   ‚îú‚îÄ‚îÄ auth/             # M√≥dulo de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ brand-registration.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/          # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register-client.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-response.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ password-reset.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create-brand.dto.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interfaces/   # Interfaces TypeScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/     # Servicios espec√≠ficos
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ brand-creation.service.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ brand-registration.service.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ color-palette.service.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ user-creation.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ common/           # Utilidades compartidas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ constants/    # Constantes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ swagger.constants.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ decorators/   # Decoradores personalizados
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ public-auth.decorator.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ swagger.decorators.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/          # DTOs compartidos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/     # Servicios compartidos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ templates/    # Plantillas (emails, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ health/           # Health checks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ health.controller.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ landing-data/     # Datos para landing page
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ landing-data.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ landing-data.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ landing-data.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ landing-data.service-new.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts
‚îÇ   ‚îú‚îÄ‚îÄ payment/          # Sistema de pagos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment-tilopay/  # Integraci√≥n con Tilopay
‚îÇ   ‚îú‚îÄ‚îÄ validate/         # Validaciones
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validate.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validate.controller.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validate.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ prisma/          # Cliente Prisma
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seed.ts
‚îÇ   ‚îú‚îÄ‚îÄ scripts/         # Scripts de utilidad
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seed-business-types.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seed-features.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seed-landing-data.ts
‚îÇ   ‚îî‚îÄ‚îÄ lib/             # Librer√≠as auxiliares
‚îÇ       ‚îî‚îÄ‚îÄ crypto.ts    # Utilidades criptogr√°ficas
‚îú‚îÄ‚îÄ test/                # Tests end-to-end
‚îÇ   ‚îú‚îÄ‚îÄ app.e2e-spec.ts
‚îÇ   ‚îî‚îÄ‚îÄ jest-e2e.json
‚îî‚îÄ‚îÄ uploads/             # Archivos subidos
    ‚îî‚îÄ‚îÄ brands/
        ‚îî‚îÄ‚îÄ logos/       # Logos de marcas
```

### üé® Est√°ndares y Convenciones de C√≥digo

#### üìù Convenciones de Nomenclatura
- **Archivos**: `kebab-case` (ej: `auth-service.ts`)
- **Classes**: `PascalCase` (ej: `AuthService`)
- **Variables/M√©todos**: `camelCase` (ej: `registerUser`)
- **Constantes**: `UPPER_SNAKE_CASE` (ej: `ERROR_CODES`)
- **Interfaces**: `PascalCase` con prefijo `I` opcional (ej: `IUser`)

#### üèóÔ∏è Estructura de M√≥dulos
Cada m√≥dulo sigue el patr√≥n de NestJS:

```typescript
module-name/
‚îú‚îÄ‚îÄ module-name.module.ts      # Configuraci√≥n del m√≥dulo
‚îú‚îÄ‚îÄ module-name.controller.ts  # Controlador HTTP
‚îú‚îÄ‚îÄ module-name.service.ts     # L√≥gica de negocio
‚îú‚îÄ‚îÄ dto/                       # Data Transfer Objects
‚îÇ   ‚îú‚îÄ‚îÄ create-item.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ update-item.dto.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ interfaces/               # Interfaces TypeScript
‚îî‚îÄ‚îÄ services/                 # Servicios auxiliares
```

#### üîß Est√°ndares de DTOs
DTOs con validaciones usando `class-validator`:

```typescript
export class RegisterClientDto {
  @ApiEmail()
  @IsEmail({}, { message: 'Email inv√°lido' })
  @IsNotEmpty({ message: 'Email es requerido' })
  email: string;

  @ApiUsername()
  @IsString({ message: 'Username debe ser texto' })
  @IsNotEmpty({ message: 'Username es requerido' })
  username: string;

  @ApiPassword()
  @IsString({ message: 'Contrase√±a debe ser texto' })
  @MinLength(6, { message: 'Contrase√±a debe tener al menos 6 caracteres' })
  password: string;
}
```

#### üéØ Decoradores Personalizados
Decoradores para Swagger:

```typescript
export const ApiEmail = () => 
  ApiProperty({ example: SWAGGER_EXAMPLES.EMAIL });

export const ApiUsername = () =>
  ApiProperty({ example: SWAGGER_EXAMPLES.USERNAME });

export const ApiPassword = () =>
  ApiProperty({ example: SWAGGER_EXAMPLES.PASSWORD });
```

#### üö¶ Manejo de Errores
Sistema centralizado de errores:

```typescript
export const ERROR_MESSAGES = {
  USERNAME_EXISTS: 'El username ya est√° en uso',
  EMAIL_ALREADY_EXISTS: 'El email ya est√° registrado',
  USER_NOT_FOUND: 'Usuario no encontrado',
} as const;

export const ERROR_CODES = {
  USERNAME_EXISTS: 1001,
  EMAIL_ALREADY_EXISTS: 1004,
  USER_NOT_FOUND: 2000,
} as const;
```

### üóÑÔ∏è Base de Datos (PostgreSQL + Prisma)

#### üìä Modelo de Datos
```prisma
model User {
  id                 Int                 @id @default(autoincrement())
  email              String              @unique
  username           String              @unique
  firstName          String?
  lastName           String?
  role               UserRole            @default(CLIENT)
  isActive           Boolean             @default(true)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  brands             Brand[]
  passwordResetCodes PasswordResetCode[]
  userBrands         UserBrand[]
}

model Brand {
  id               Int            @id @default(autoincrement())
  name             String
  description      String?
  address          String?
  phone            String?
  isActive         Boolean        @default(true)
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  ownerId          Int
  businessType     String?
  selectedFeatures String[]
  imagotipoUrl     String?
  isotopoUrl       String?
  logoUrl          String?
  owner            User           @relation(fields: [ownerId], references: [id])
  colorPalette     ColorPalette?
}
```

#### üé® Enums
```prisma
enum UserRole {
  ROOT
  CLIENT
  ADMIN
}

enum PlanType {
  web
  app
  complete
}

enum PaymentStatus {
  pending
  processing
  completed
  failed
  cancelled
}
```

### üîß M√≥dulos Principales

#### üîê AuthModule
- **Archivos**: `auth.controller.ts`, `auth.service.ts`, `brand-registration.controller.ts`
- **Endpoints**:
  ```typescript
  POST /auth/register/client
  POST /auth/register/brand
  POST /auth/forgot-password
  POST /auth/validate-reset-code
  POST /auth/reset-password
  ```
- **Funcionalidades**: Registro, autenticaci√≥n JWT, recuperaci√≥n de contrase√±a.

#### üìä LandingDataModule
- **Responsabilidades**: Proveer datos para interfaces externas, tipos de negocio, features, planes.
- **Endpoints**:
  ```typescript
  GET /landing-data/config
  GET /landing-data/business-types
  GET /landing-data/features
  GET /landing-data/plans
  ```

#### üí≥ PaymentModule
- **Integraci√≥n**: Tilopay
- **Funcionalidades**: Procesamiento de pagos, webhooks, estados de transacciones.

#### ‚úÖ ValidateModule
- **Endpoints**:
  ```typescript
  POST /validate/usernamearnia
  POST /validate/email
  ```

#### üè• HealthModule
- **Funcionalidad**: Health checks, verificaci√≥n de conexiones.

### üöÄ Scripts y Comandos

```bash
# Desarrollo
npm run start:dev
npm run start:debug
npm run build
npm run start:prod

# Base de datos
npx prisma generate
npx prisma migrate dev
npx prisma migrate deploy
npx prisma db push
npx prisma studio

# Seeds
npm run prisma:seed

# Testing
npm run test
npm run test:watch
npm run test:cov
npm run test:e2e

# Linting
npm run lint
npm run format
```

### ‚öôÔ∏è Configuraci√≥n ESLint

```javascript
export default tseslint.config(
  eslint.configs.recommended,
  ...tseslint.configs.recommendedTypeChecked,
  eslintPluginPrettierRecommended,
  {
    languageOptions: {
      globals: { ...globals.node, ...globals.jest },
      parserOptions: {
        projectService: true,
        tsconfigRootDir: import.meta.dirname,
      },
    },
    rules: {
      '@typescript-eslint/no-explicit-any': 'off',
      '@typescript-eslint/no-floating-promises': 'warn',
      '@typescript-eslint/no-unsafe-argument': 'warn'
    },
  }
);
```

### üîê Variables de Entorno

```env
DATABASE_URL="postgresql://username:password@localhost:5432/database"
JWT_SECRET="your-super-secret-jwt-key"
JWT_EXPIRES_IN="24h"
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"
TILOPAY_BASE_URL="https://sandbox.tilopay.com"
TILOPAY_API_KEY="your-tilopay-api-key"
TILOPAY_SECRET="your-tilopay-secret"
PORT=3000
NODE_ENV="development"
```

---

## üì± Frontend Mobile (React Native/Expo)

### üìÇ Estructura del Proyecto

```
frontend/
‚îú‚îÄ‚îÄ app.json              # Configuraci√≥n Expo
‚îú‚îÄ‚îÄ babel.config.js       # Configuraci√≥n Babel
‚îú‚îÄ‚îÄ eslint.config.js      # Configuraci√≥n ESLint
‚îú‚îÄ‚îÄ metro.config.js       # Configuraci√≥n Metro
‚îú‚îÄ‚îÄ package.json          # Dependencias y scripts
‚îú‚îÄ‚îÄ tailwind.config.js    # Configuraci√≥n Tailwind
‚îú‚îÄ‚îÄ tsconfig.json         # Configuraci√≥n TypeScript
‚îî‚îÄ‚îÄ src/                  # C√≥digo fuente
    ‚îú‚îÄ‚îÄ globals.css       # Estilos globales
    ‚îú‚îÄ‚îÄ api/              # Cliente HTTP
    ‚îÇ   ‚îú‚îÄ‚îÄ constants.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ endpoints.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ types.ts
    ‚îú‚îÄ‚îÄ app/              # Navegaci√≥n (Expo Router)
    ‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ +not-found.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ (client-tabs)/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ appointments.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ (admin-tabs)/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clients.tsx
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.tsx
    ‚îú‚îÄ‚îÄ assets/           # Recursos
    ‚îÇ   ‚îú‚îÄ‚îÄ fonts/
    ‚îÇ   ‚îî‚îÄ‚îÄ images/
    ‚îú‚îÄ‚îÄ components/       # Componentes reutilizables
    ‚îÇ   ‚îú‚îÄ‚îÄ Collapsible.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ EmailValidationIndicator.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ PasswordStrengthIndicator.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ UsernameValidationIndicator.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ ThemedText.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ ThemedView.tsx
    ‚îú‚îÄ‚îÄ constants/        # Constantes
    ‚îÇ   ‚îú‚îÄ‚îÄ Colors.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ ErrorConstants.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ Plans.ts
    ‚îú‚îÄ‚îÄ contexts/         # Contextos React
    ‚îÇ   ‚îú‚îÄ‚îÄ AppContext.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ ThemeContext.tsx
    ‚îÇ   ‚îú‚îÄ‚îÄ ErrorContext.tsx
    ‚îú‚îÄ‚îÄ hooks/            # Hooks personalizados
    ‚îÇ   ‚îú‚îÄ‚îÄ useColorScheme.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ useDebounce.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ useEmailValidation.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ usePasswordValidation.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ useUsernameValidation.ts
    ‚îú‚îÄ‚îÄ navigation/       # Configuraci√≥n de navegaci√≥n
    ‚îÇ   ‚îî‚îÄ‚îÄ AppNavigator.tsx
    ‚îú‚îÄ‚îÄ services/         # Servicios
    ‚îÇ   ‚îú‚îÄ‚îÄ authService.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ planService.ts
    ‚îú‚îÄ‚îÄ types/            # Tipos
    ‚îÇ   ‚îú‚îÄ‚îÄ auth.types.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ error.types.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ plan.types.ts
    ‚îî‚îÄ‚îÄ utils/            # Utilidades
        ‚îú‚îÄ‚îÄ errorBoundary.ts
        ‚îú‚îÄ‚îÄ errorUtils.ts
        ‚îú‚îÄ‚îÄ logger.ts
        ‚îú‚îÄ‚îÄ responsive.ts
        ‚îú‚îÄ‚îÄ validators.ts
```

### üé® Est√°ndares y Convenciones de C√≥digo

#### üìù Convenciones de Nomenclatura
- **Componentes**: `PascalCase` (ej: `EmailValidationIndicator.tsx`)
- **Hooks**: `camelCase` con prefijo `use` (ej: `useEmailValidation.ts`)
- **Services**: `camelCase` con sufijo `Service` (ej: `authService.ts`)
- **Types**: `PascalCase` con sufijo `Type` o `Interface`
- **Constants**: `UPPER_SNAKE_CASE`

#### üèóÔ∏è Estructura de Componentes

```typescript
interface EmailValidationIndicatorProps {
  email: string;
  isValid: boolean;
  isChecking: boolean;
  error?: string;
}

export const EmailValidationIndicator: React.FC<EmailValidationIndicatorProps> = ({
  email,
  isValid,
  isChecking,
  error
}) => {
  const borderColor = useThemeColor({}, 'border');
  return (
    <ThemedView style={{ borderColor }}>
      {/* Implementaci√≥n */}
    </ThemedView>
  );
};
```

#### üéØ Hooks Personalizados

```typescript
export const useEmailValidation = () => {
  const [email, setEmail] = useState('');
  const [isValid, setIsValid] = useState(false);
  const [isChecking, setIsChecking] = useState(false);
  const [error, setError] = useState<string>();

  const validateEmailAsync = async (emailValue: string) => {
    if (!emailValue) return;
    setIsChecking(true);
    setError(undefined);
    try {
      const result = await validateEmail(emailValue);
      setIsValid(result.isValid);
      if (!result.isValid) setError(result.message);
    } catch (err) {
      setError('Error validando email');
      setIsValid(false);
    } finally {
      setIsChecking(false);
    }
  };

  return { email, setEmail, isValid, isChecking, error, validateEmailAsync };
};
```

### üîß Configuraci√≥n y Herramientas

#### üì¶ Dependencias

```json
{
  "dependencies": {
    "expo": "~53.0.20",
    "react": "19.0.0",
    "react-native": "0.79.5",
    "expo-router": "~5.1.4",
    "nativewind": "^2.0.11",
    "@react-navigation/native": "^7.1.17",
    "@react-navigation/bottom-tabs": "^7.3.10",
    "@react-native-async-storage/async-storage": "^2.2.0",
    "expo-linear-gradient": "^14.1.5",
    "expo-haptics": "~14.1.4",
    "expo-image": "~2.4.0",
    "lucide-react-native": "^0.539.0"
  },
  "devDependencies": {
    "@types/react": "~19.0.10",
    "typescript": "~5.8.3",
    "eslint": "^9.25.0",
    "eslint-config-expo": "~9.2.0",
    "tailwindcss": "^3.3.0"
  }
}
```

#### üé® Configuraci√≥n NativeWind

```javascript
module.exports = {
  content: ['./src/**/*.{js,jsx,ts,tsx}'],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#f0f9ff',
          500: '#3b82f6',
          600: '#2563eb',
        },
      },
    },
  },
  plugins: [],
};
```

#### ‚öôÔ∏è Configuraci√≥n Metro

```javascript
const { getDefaultConfig } = require('expo/metro-config');
const { withNativeWind } = require('nativewind/metro');

const config = getDefaultConfig(__dirname);
module.exports = withNativeWind(config, { input: './src/globals.css' });
```

### üîó Integraci√≥n con API

#### üåê Cliente HTTP

```typescript
const apiRequest = async <T>(
  endpoint: string,
  method: 'GET' | 'POST' | 'PUT' | 'DELETE' = 'GET',
  body?: any
): Promise<T> => {
  const url = `${BASE_URL}${endpoint}`;
  const config: RequestInit = {
    method,
    headers: { 'Content-Type': 'application/json' },
  };
  if (body && method !== 'GET') config.body = JSON.stringify(body);
  const response = await fetch(url, config);
  if (!response.ok) {
    const errorData = await response.json().catch(() => ({}));
    throw new Error(errorData.message || `API Error: ${response.status}`);
  }
  return response.json();
};
```

#### üîê Autenticaci√≥n

```typescript
export class AuthService {
  private static TOKEN_KEY = 'auth_token';

  static async login(credentials: LoginRequest): Promise<boolean> {
    try {
      const response = await loginUser(credentials);
      if (response.success && response.token) {
        await AsyncStorage.setItem(this.TOKEN_KEY, response.token);
        return true;
      }
      return false;
    } catch (error) {
      console.error('Login error:', error);
      return false;
    }
  }

  static async logout(): Promise<void> {
    await AsyncStorage.removeItem(this.TOKEN_KEY);
  }

  static async getToken(): Promise<string | null> {
    return AsyncStorage.getItem(this.TOKEN_KEY);
  }
}
```

### üìä Contextos

#### üåç AppContext

```typescript
export interface User {
  id: string;
  name: string;
  email: string;
  role: 'admin' | 'client';
  businessName?: string;
}

interface AppContextType {
  user: User | null;
  services: Service[];
  appointments: Appointment[];
  login: (email: string, password: string) => Promise<boolean>;
  logout: () => void;
}
```

#### üé® ThemeContext

```typescript
interface ThemeContextType {
  theme: 'light' | 'dark';
  toggleTheme: () => void;
  colors: {
    primary: string;
    background: string;
    text: string;
  };
}
```

### üß™ Validaciones y Errores

#### ‚úÖ Validaciones

```typescript
export const validators = {
  email: (email: string): boolean => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email),
  password: (password: string): { isValid: boolean; strength: 'weak' | 'medium' | 'strong'; issues: string[] } => {
    // L√≥gica de validaci√≥n
  },
  username: (username: string): boolean => username.length >= 3 && /^[a-zA-Z0-9_]+$/.test(username),
};
```

#### üö® Manejo de Errores

```typescript
interface ErrorContextType {
  errors: ErrorMessage[];
  addError: (error: ErrorMessage) => void;
  removeError: (id: string) => void;
  clearErrors: () => void;
}

export const handleApiError = (error: any): string => {
  if (error.response?.data?.message) return error.response.data.message;
  if (error.message) return error.message;
  return 'Ha ocurrido un error inesperado';
};
```

### üöÄ Scripts y Comandos

```bash
npm start
npm run android
npm run ios
npm run web
npx expo build:android
npx expo build:ios
npx expo publish
npx expo start --clear
npx expo install
npx expo prebuild
npm run lint
```

### üì± Navegaci√≥n (Expo Router)

```
app/
‚îú‚îÄ‚îÄ _layout.tsx
‚îú‚îÄ‚îÄ index.tsx
‚îú‚îÄ‚îÄ +not-found.tsx
‚îú‚îÄ‚îÄ (auth)/
‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îú‚îÄ‚îÄ login.tsx
‚îÇ   ‚îú‚îÄ‚îÄ register.tsx
‚îú‚îÄ‚îÄ (client-tabs)/
‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îú‚îÄ‚îÄ appointments.tsx
‚îÇ   ‚îú‚îÄ‚îÄ services.tsx
‚îÇ   ‚îú‚îÄ‚îÄ profile.tsx
‚îú‚îÄ‚îÄ (admin-tabs)/
‚îÇ   ‚îú‚îÄ‚îÄ _layout.tsx
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.tsx
‚îÇ   ‚îú‚îÄ‚îÄ clients.tsx
‚îÇ   ‚îú‚îÄ‚îÄ settings.tsx
```

---

## üîÑ Integraci√≥n Backend ‚Üî Frontend

### üì° Comunicaci√≥n API

```mermaid
graph LR
    A[Mobile App] --> B[HTTP Client]
    B --> C[Backend API]
    C --> D[PostgreSQL]
    C --> E[External Services]
    E --> F[Tilopay]
    E --> G[SMTP]
```

### üîê Flujo de Autenticaci√≥n
1. Ingreso de credenciales (Frontend)
2. Validaci√≥n local (Hooks)
3. Env√≠o a API (`POST /auth/login`)
4. Verificaci√≥n (AuthService)
5. Generaci√≥n de JWT
6. Almacenamiento (AsyncStorage)
7. Navegaci√≥n a pantallas autenticadas

### üõ°Ô∏è Seguridad
- Hashing con bcrypt
- Tokens JWT
- Validaciones robustas
- Variables de entorno seguras
- Manejo seguro de errores
- Rate limiting (pendiente)

---

### üîç Herramientas de Debugging
- **Backend**: Prisma Studio, Swagger UI (`http://localhost:3000/api`), debug mode
- **Frontend**: Expo Dev Tools, React Native Debugger, Flipper


*√öltima actualizaci√≥n: 11 de agosto de 2025*